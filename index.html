<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Scala Traits</title>

		<meta name="description" content="Rough notes...and still not much useful">
		<meta name="author" content="Jacek Laskowski">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/beige.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', include the PDF print sheet -->
		<script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = 'css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>Scala Traits</h1>
					<h3>Rough notes...and still not much useful</h3>
					<p>
						<small>Created by <a href="http://blog.jaceklaskowski.pl">Jacek Laskowski</a> / <a href="http://twitter.com/jaceklaskowski">@jaceklaskowski</a></small>
					</p>
				</section>

				<section data-transition="linear" data-background-transition="slide">
					<h2>Friendly Heads-Up</h2>
					<div style="position: relative">
					<p>
						This presentation is
						<span style="display:inline-block;position:relative">
							a mere summary
							<span style="position:absolute;display:inline-block;padding:4px;border-radius:10px;top:-4px;left:-4px;background-color:#eee8d5;color:#1B2C3D;font-weight:bold" class="fragment">a mere summary</span>
						</span>
						of what I could learn from the many sources available on the Internet.
						<br>
						I wholeheartedly apologise for being incompetent to yield added value besides the presentation itself.
					</p>
					</div>
				</section>

				<section>
					<section data-markdown>
						<script type="text/template">
							## Programming in Scala, First Edition

							### Chapter 12 Traits
							by Martin Odersky, Lex Spoon, and Bill Venners<br>
							December 10, 2008<br>
							http://www.artima.com/pins1ed/traits.html
						</script>
					</section>
					<section data-markdown>
						<script type="text/template">
							## Introduction

							* Traits are **a fundamental unit of code reuse** in Scala.
							* A trait encapsulates **method and field definitions**.
							* Reused by **mixing** them into classes
							* A class can mix in **any number of traits**
							* **Two** of the most common ways they are useful
								* widening thin interfaces to rich ones
								* defining stackable modifications
						</script>
					</section>
					<section data-markdown>
						<script type="text/template">
## 12.1 How traits work

```scala
package scala

// See http://www.scala-lang.org/api/current/#scala.Function1
trait Function1[-T1, +R] extends AnyRef {
  def apply(v1: T1): R
}
```

* `trait` keyword defines a new trait
* `Function1` trait has the (implicit) default superclass of `AnyRef`
* Can be *mixed in* using either `extends` or `with` keywords

```scala
class F_Int2Int extends Function1[Int, Int] {
  def apply(x: Int): Int = x + 1
}
```

* `F_Int2Int` class implicitly inherit the trait's superclass - `AnyRef`
						</script>
					</section>
					<section data-markdown>
						<script type="text/template">
## trait Function1

```scala
scala> val f = new Function1[Int, Int] {
     |   def apply(x: Int): Int = x + 1
     | }
f: Function1[Int,Int] = $anon$1@59020d40

scala> f(0)
res0: Int = 1
```
						</script>
					</section>
					<section data-markdown>
						<script type="text/template">
## 12.1 How traits work cont.

* [scala.App](http://scala-lang.org/api/current/#scala.App) trait definition

```scala
package scala

import scala.compat.Platform.currentTime
import scala.collection.mutable.ListBuffer

trait App extends DelayedInit {
  protected def args: Array[String] = ...
  def main(args: Array[String]) = { ... }
}
```

* Implementation

```scala
object Main extends App {
  Console.println("Hello World: " + (args mkString ", "))
}
```
						</script>
					</section>
					<section data-markdown>
						<script type="text/template">
## 12.1 How traits work cont.

```scala
// from Akka's akka.actor package
trait ActorLogging { this: Actor â‡’
  private var _log: LoggingAdapter = _

  def log: LoggingAdapter = {
    // only used in Actor, i.e. thread safe
    if (_log eq null)
      _log = akka.event.Logging(context.system, this)
    _log
  }

}
```
						</script>
					</section>
					<section data-markdown>
						<script type="text/template">
## Speakable trait

```scala
trait Speakable {
  def speak() = {
    println("I am indeed speaking")
  }
}
```

* No explicit `extends` means `AnyRef`
* A single definition of concrete method `speak`

```scala
scala> val s = new Speakable {}
s: Speakable = $anon$1@22f195ea

scala> s.speak
I am indeed speaking
```

						</script>
					</section>
					<section data-markdown>
						<script type="text/template">
## Speakable trait cont.

```scala
class Human extends Speakable {
  override def speak() = {
    println("Hello, a Human speaking")
  }
}
```

* Note `override` keyword to override default implementation of `speak` method

```scala
scala> val h = new Human
h: Human = Human@962345b

scala> h.speak
Hello, a Human speaking
```

						</script>
					</section>
					<section data-markdown>
						<script type="text/template">
## Trait is type

* A trait also defines a type

```scala
scala> val s: Speakable = new Human
s: Speakable = Human@65c7d581

scala> s.speak
Hello, a Human speaking
```

* `s` could have been initialized with any object that has `Speakable` mixed in

						</script>
					</section>
					<section data-markdown>
						<script type="text/template">
## Single extends, multiple with

* Mind the singulars and plurals :-)

```scala
class Animal
trait CanWalk

class Human extends Animal with Speakable with CanWalk {
  override def speak() = {
    println("Hello, a Human speaking")
  }
}
```

* Scala allows for at most one superclass and zero or many traits
* When no superclass is explicitly defined use `extends` for the first trait

```scala
trait CanWalk
trait CanSing

class Living extends CanWalk with CanSing
```

* What methods are part the class' API?
						</script>
					</section>
				</section>

				<section>
					<section data-markdown>
						<script type="text/template">
							## Spray-Swagger project

							Spray-Swagger brings [Swagger](https://github.com/wordnik/swagger-core) support for [Spray](http://spray.io/) APIs.<br>
							https://github.com/gettyimages/spray-swagger
						</script>
					</section>
					<section data-markdown>
						<script type="text/template">
							## SwaggerHttpService

							* The `SwaggerHttpService` is a trait extending Spray's `HttpService`
						</script>
					</section>
				</section>

				<section data-markdown>
					<script type="text/template">
					## Traits the very beginning

					* Let's start with 
					* traits are used to define object types by specifying the signature of the supported methods.
					* Scala allows traits to be partially implemented; i.e. it is possible to define default implementations for some methods.
					* Traits can inherit from other traits or from classes.
					* Mixin composition in Scala occurs at compile time.
					</script>
				</section>

				<section data-markdown>
					<script type="text/template">
					## Traits

					* Traits are useful for mixing functionality into a class.
					* traits are used to define object types by specifying the signature of the supported methods.
					* Scala allows traits to be partially implemented; i.e. it is possible to define default implementations for some methods.
					* Traits can inherit from other traits or from classes.
					* Mixin composition in Scala occurs at compile time.
					</script>
				</section>

				<section data-markdown>
					<script type="text/template">
					## Trait inheritance vs self-types (1 of 2)

* `A` cannot be mixed into a concrete class that does not also extend `B`, i.e. `A` *uses-a* `B`:

```
trait B
trait A { this: B => }
```

* any (concrete or abstract) class mixing in `A` will also be mixing in `B`, i.e. `A` *is-a* `B`:

```
trait B
trait A extends B
```

* Using type parameters within self-types legal

```
trait A[Self] {this: Self => }  // correct
trait A[Self] extends Self      // incorrect
```

					</script>
				</section>

				<section data-markdown>
					<script type="text/template">
					## Trait inheritance vs self-types (2 of 2)

* Self types allow you to define cyclical dependencies

```
trait A { self: B => }
trait B { self: A => }
```

* Inheritance using `extends` does not allow that

```
trait A extends B
trait B extends A
error:  illegal cyclic reference involving trait A
```

* self-types as structural types, i.e. anything that mixes in `Foo` must implement a no-arg `close` method returning `Unit`.
```
trait Foo {
   this => { def close: Unit }
}
```
					</script>
				</section>

				<section data-markdown>
					<script type="text/template">
					## Cake pattern

```
trait AB {
  def fa: String
  def fb: String }
trait A1 extends AB
{ override def fa = "A's String" }
trait B1 extends AB
{ override def fb = "B's String" }
val myObj = new A1 with B1
```
					</script>
				</section>

				<section data-markdown>
					<script type="text/template">
					## Traits are stackable

					* `super` calls in a trait are dynamically bound (it is referring a class or trait mixed before current one)

```
trait A{
    def a = 1
}

trait X extends A{
    override def a = {
        println("X")
        super.a
    }
}  


trait Y extends A{
    override def a = {
        println("Y")
        super.a
    }
}

scala> val xy = new AnyRef with X with Y
xy: java.lang.Object with X with Y = $anon$1@6e9b6a
scala> xy.a
Y
X
res0: Int = 1

scala> val yx = new AnyRef with Y with X
yx: java.lang.Object with Y with X = $anon$1@188c838
scala> yx.a
X
Y
res1: Int = 1
```
					</script>
				</section>

				<section data-markdown>
					<script type="text/template">
					## Traits vs abstract classes

					* **Abstract classes** can have constructor parameters as well as type parameters.
					* **Traits** can have only type parameters.
					* **Abstract classes** are fully interoperable with Java. You can call them from Java code without any wrappers.
					* **Traits** are fully interoperable only if they do not contain any implementation code
					* When you're doubt, use traits.
					* you cannot directly extend multiple abstract classes
					* you can mixin multiple traits into a class
					</script>
				</section>

				<section data-markdown>
					<script type="text/template">
					## Credits

					* Hakim El Hattab for [reveal.js - The HTML Presentation Framework](http://lab.hakim.se/reveal-js/)
					* [StackOverflow](http://stackoverflow.com/search?q=scala+trait)
					</script>
				</section>

				<section data-markdown>
					<script type="text/template">
					# The End

					### BY Jacek Laskowski / [blog.jaceklaskowski.pl](http://blog.jaceklaskowski.pl)
					</script>
				</section>

			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>

	</body>
</html>
